<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Marketlist)</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8 font-sans">
  <div class="max-w-md mx-auto bg-white p-6 rounded shadow">
    <h1 class="text-xl font-bold mb-4">üîç ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤<br><small>(‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å Marketlist)</small></h1>
    <label class="block mb-2">
      üì¶ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠:
      <input id="itemInput" list="itemSuggestions" class="w-full p-2 border rounded" placeholder="‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠..." />
    </label>
    <datalist id="itemSuggestions"></datalist>
  </div>

  <script>
    // URL Web App (exec)
    const scriptURL = 'https://script.google.com/macros/s/AKfycby‚Ä¶/exec';

    async function loadMarketItems() {
      // ‡∏î‡∏∂‡∏á JSON ‡∏ï‡∏£‡∏á‡πÜ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á callback
      const res = await fetch(`${scriptURL}?sheet=marketlist`);
      if (!res.ok) throw new Error('Fetch failed: ' + res.status);
      const wrapped = await res.json();
      // wrapped ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô array ‡πÄ‡∏•‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠ object { marketlist: [...] }
      const data = Array.isArray(wrapped)
        ? wrapped
        : (wrapped.marketlist || []);
      console.log('Marketlist data:', data);

      const dl = document.getElementById('itemSuggestions');
      dl.innerHTML = '';
      data.forEach(row => {
        // ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö header ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ï: MetrialName
        const name = row['MetrialName'];
        if (name) {
          const opt = document.createElement('option');
          opt.value = name.trim();
          dl.appendChild(opt);
        }
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadMarketItems().catch(err => console.error(err));
    });
  </script>
</body>
</html>
