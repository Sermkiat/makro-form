<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ö‡∏¥‡∏• / ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</title>
  <style>
    /* CSS ‡πÄ‡∏î‡∏¥‡∏° (‡∏ï‡∏±‡∏î‡∏ó‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö) */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { background-color: #5fa0ff; font-family: 'Noto Sans', sans-serif; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; padding: env(safe-area-inset-top) 16px env(safe-area-inset-bottom) 16px; }
    .container { background: #fff; border: 3px solid #c2e7ff; border-radius: 24px; width: 100%; max-width: 420px; padding: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    h1 { font-size: 20px; text-align: center; margin-bottom: 16px; padding-bottom: 10px; border-bottom: 4px solid #c2e7ff; }
    .form-row { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 16px; }
    .form-group { flex: 1 1 calc(50% - 6px); display: flex; flex-direction: column; }
    .form-group input { width: 100%; padding: 10px 12px; font-size: 14px; height: 40px; border: 1px solid #ccc; border-radius: 8px; }
    .items { margin-top: 16px; }
    .btn-row { display: flex; gap: 12px; margin-top: 20px; }
    #add-item, #submit { flex: 1; padding: 12px; font-size: 15px; border-radius: 10px; cursor: pointer; text-align: center; height: 44px; line-height: 1.3; border: none; }
    #add-item { background: #ffdb4d; color: #111827; }
    #submit { background: #4d83ff; color: #fff; }
    .menu-links { display: flex; flex-wrap: wrap; gap: 12px; margin-top: 24px; padding-top: 16px; justify-content: space-between; }
    .btn-nav { flex: 1; padding: 12px 8px; font-size: 15px; font-weight: bold; text-align: center; color: #fff; border-radius: 12px; text-decoration: none; }
    .btn-blue { background-color: #3b82f6; } .btn-green { background-color: #10b981; } .btn-purple { background-color: #8b5cf6; }
    .btn-blue:hover { background-color: #2563eb; } .btn-green:hover { background-color: #059669; } .btn-purple:hover { background-color: #7c3aed; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
  <div class="container">
    <h1>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ö‡∏¥‡∏•/‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h1>
    <!-- wrap with form for native validation -->
    <form id="billForm" novalidate>
      <div class="form-row">
        <div class="form-group">
          <label>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠</label>
          <input type="date" id="date_bill" required />
        </div>
        <div class="form-group">
          <label>üè™ ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠</label>
          <input type="text" id="supplier" list="supplierlist" placeholder="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠" required />
        </div>
      </div>

      <div class="items" id="items-container"></div>

      <div class="btn-row">
        <button type="button" id="add-item">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</button>
        <button type="submit" id="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      </div>
    </form>

    <nav class="menu-links">
      <a href="index.html" class="btn-nav btn-blue">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
      <a href="income.html" class="btn-nav btn-green">üíµ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö/‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</a>
      <a href="dashboard.html" class="btn-nav btn-purple">üìä Dashboard</a>
    </nav>
  </div>

  <datalist id="namelist"></datalist>
  <datalist id="supplierlist"><option value="Makro"><option value="7-eleven"><option value="Tops"><option value="Lotus"><option value="Lazada"><option value="Shopee"></datalist>

  <template id="item-template">
  <div class="item">
    <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà <span class="item-index">1</span></h2>

    <!-- ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ + ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà -->
    <div class="item-grid header">
      <input type="text" class="name" list="namelist" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" />
      <input type="text" class="group" list="grouplist" placeholder="‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" />
    </div>
    <datalist id="grouplist">
      <option value="‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≤‡∏ß"><option value="‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß ‡∏Å‡∏¥‡∏ô‡∏Ç‡∏ô‡∏°"><option value="‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô">
      <option value="‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô/‡πÉ‡∏ä‡πâ‡∏û‡∏£‡∏≤‡∏ß"><option value="‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß"><option value="‡∏¢‡∏≤">
      <option value="‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß/‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô"><option value="‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°"><option value="‡∏á‡∏≤‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á">
    </datalist>

    <!-- Amount | Unit | Price Unit | Total -->
    <div class="item-grid main">
      <input type="number" class="amount" placeholder="Amount" />
      <input type="text"   class="unit"   placeholder="Unit" />
      <input type="number" class="price_unit" step="0.01" placeholder="Price Unit" />
      <input type="text"   class="total" readonly placeholder="Total" />
    </div>

    <!-- In unit | Sec Unit | Remarks -->
    <div class="item-grid secondary">
      <input type="text" class="in_unit" placeholder="In unit" />
      <input type="text" class="sec_unit" placeholder="Sec Unit" />
      <input type="text" class="note" placeholder="Remarks" />
    </div>

    <button class="remove">‡∏•‡∏ö</button>
  </div>
  </template>

  <script>
    const apiURL = 'https://script.google.com/macros/s/‚Ä¶/exec';
    // loadData(), handleData(), addItemRow(), updateItemIndices(), resetForm() ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°

    // ‡∏õ‡∏£‡∏±‡∏ö event listener ‡πÉ‡∏´‡πâ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏ä‡πâ native validation
    document.getElementById('billForm').addEventListener('submit', e => {
      e.preventDefault();
      const form = e.target;
      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }
      // ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å validate ‡∏ú‡πà‡∏≤‡∏ô ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á items[], ‡πÅ‡∏™‡∏î‡∏á Swal confirm, ‡∏à‡∏±‡∏î‡∏™‡πà‡∏á JSONP
    });

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    loadData();
    addItemRow();
  </script>
</body>
</html>
