<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üìä ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/tabletop@1.6.4/src/tabletop.js"></script>
  <style>
    body { font-family: sans-serif; }
    input[type="search"] {
      border: 1px solid #ccc;
      padding: 8px;
      border-radius: 6px;
      width: 100%;
    }
  </style>
</head>
<body class="bg-gray-100 p-4">
  <div class="max-w-6xl mx-auto bg-white p-6 rounded-lg shadow">
    <h1 class="text-2xl font-bold mb-4">üìä ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</h1>

    <input type="search" id="searchInput" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ö‡∏¥‡∏• / ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ / ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà..." class="mb-4" />

    <div class="overflow-x-auto">
      <table id="dataTable" class="w-full table-auto border">
        <thead class="bg-gray-200 text-sm">
          <tr>
            <th class="border p-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠</th>
            <th class="border p-2">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ö‡∏¥‡∏•</th>
            <th class="border p-2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
            <th class="border p-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
            <th class="border p-2">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
            <th class="border p-2">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°</th>
            <th class="border p-2">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤</th>
          </tr>
        </thead>
        <tbody id="tableBody" class="text-sm"></tbody>
      </table>
    </div>
  </div>

  <script>
    const sheetUrl = "https://docs.google.com/spreadsheets/d/1bniIL-y285kEHvF_bzRRBOUYGrwcjwEaIrxWGIwh71s/edit?usp=sharing";

    window.addEventListener("DOMContentLoaded", () => {
      Tabletop.init({
        key: sheetUrl,
        simpleSheet: true,
        callback: function (data) {
          const tableBody = document.getElementById("tableBody");
          data.forEach(row => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td class="border p-2">${row.date || ""}</td>
              <td class="border p-2">${row.billNo || ""}</td>
              <td class="border p-2">${row.item || ""}</td>
              <td class="border p-2 text-center">${row.qty || ""}</td>
              <td class="border p-2 text-right">${row.unitPrice || ""}</td>
              <td class="border p-2 text-right font-semibold text-green-600">${row.totalPrice || ""}</td>
              <td class="border p-2">${row.timestamp || ""}</td>
            `;
            tableBody.appendChild(tr);
          });

          // Search filter
          const searchInput = document.getElementById("searchInput");
          searchInput.addEventListener("input", () => {
            const value = searchInput.value.toLowerCase();
            const rows = document.querySelectorAll("#tableBody tr");
            rows.forEach(row => {
              const text = row.textContent.toLowerCase();
              row.style.display = text.includes(value) ? "" : "none";
            });
          });
        }
      });
    });
  </script>
</body>
</html>